# Introduction to Authentication

- _"No query strings for passwords EVER"._

**What is a hash?**
- A hash is a mathematical function that when given an input returns a string of fixed length.
- To be effective it should:
  - Be Deterministic
  - Output a set length string
  - Be Nonreversible
  - Be infeasible to find hash
  - Yield a completely different output when inputs are similar

**What is a collision?**
- Hash functions can theoretically take every value in the known universe as an input, but return a string of fixed length.
- As the output is of fixed length there is a maximum amount of different outputs. This gives rise to the concept of **collisions**
- Collisions are where two input strings of a hash function produce the same hash result.

**Why are hash collisions bad?**
- File integrity checks will be compromised.
- Exploitation of applications that uses password hashes.
- Malicious files and viruses downloads.

**Attacking Hashed Passwords**
- One method would be building a table of hashes from the most common passwords and comparing each of them against the hashed value on the database.
- Large versions of these tables generated by powerful processors are called **Rainbow Tables**
- Disgruntled Employees...

**Defeating The Rainbow Table**
- We can increase the entropy of simple passwords by concatenating a **secret** before we hash the passwords.
  - A secret is a fixed string that is concatenated to the password before hashing.
  - The problem with the secret is that if it is leaked, an attacker can generate a new rainbow table based on the secret.
- We can generate a random unique secret per user and store this with the user. This is called a **salt**
  - Having these salts in plain sight is okay because an attacker would need to generate a rainbow table per user which would make it practically infeasible to acquire every password on the database.
  - The tradeoff is that an attacker would feasibly be able to attack a single or few users.

**The Bcrypt Hash Salt Method**
1. Generate Random salt
1. Hash password + salt
1. Prepend salt to hash
1. Save to database


**Using Bcrypt**
```
const bcrypt = require('bcryptjs');
```

```
const hash = bcrypt.hashSync(user.password, <Num Of Loops>);
```

```
// Comparing login credentials with database

bcrypt.compareSync(credentials.password, user.password);

// => returns true or false
```


**Hashing vs Encryption**
- Hashing = One-way function
- Encryption = Bidirectional function (uses private keys to decrypt)

**Further Reading:**
- _[Security by Design](https://www.owasp.org/index.php/Security_by_Design_Principles)_
